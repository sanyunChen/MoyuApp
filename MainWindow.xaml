<Window x:Class="MoyuApp.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        mc:Ignorable="d"
        Title="æ‘¸é±¼åŠžä»ªè¡¨ç›˜ v1.0" Height="700" Width="1100"
        WindowStartupLocation="CenterScreen"
        Background="{DynamicResource MaterialDesignPaper}"
        FontFamily="Microsoft YaHei UI"
        >
    
    <Window.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="Themes/LightTheme.xaml"/>
            </ResourceDictionary.MergedDictionaries>
            
            <!-- å¡ç‰‡æ ·å¼ -->
            <Style x:Key="MoyuCardStyle" TargetType="materialDesign:Card">
                <Setter Property="Padding" Value="22"/>
                <Setter Property="Margin" Value="8"/>
                <Setter Property="UniformCornerRadius" Value="14"/>
            </Style>
            
            <!-- æ ‡é¢˜æ ·å¼ -->
            <Style x:Key="ModuleTitleStyle" TargetType="TextBlock">
                <Setter Property="FontSize" Value="18"/>
                <Setter Property="FontWeight" Value="Bold"/>
                <Setter Property="Margin" Value="0,0,0,12"/>
                <Setter Property="Foreground" Value="{DynamicResource PrimaryHueMidBrush}"/>
            </Style>
            
            <!-- è¿›åº¦æ¡æ ·å¼ -->
            <Style x:Key="MoyuProgressBar" TargetType="ProgressBar">
                <Setter Property="Height" Value="14"/>
                <Setter Property="Margin" Value="0,10,0,5"/>
                <Setter Property="BorderThickness" Value="0"/>
                <Setter Property="Background" Value="#FFE0E0E0"/>
                <Setter Property="Foreground" Value="{DynamicResource SecondaryHueMidBrush}"/>
            </Style>
            
            <!-- å¯ç¼–è¾‘æ–‡æœ¬æ ·å¼ -->
            <Style x:Key="EditableTextStyle" TargetType="TextBlock">
                <Setter Property="Cursor" Value="Hand"/>
                <Setter Property="TextTrimming" Value="CharacterEllipsis"/>
                <Style.Triggers>
                    <Trigger Property="IsMouseOver" Value="True">
                        <Setter Property="Background" Value="#10FF4081"/>
                    </Trigger>
                </Style.Triggers>
            </Style>
        </ResourceDictionary>
    </Window.Resources>
    
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        
        <!-- æ ‡é¢˜æ  -->
        <materialDesign:ColorZone Grid.Row="0" Mode="PrimaryMid" Padding="20,15">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <StackPanel Grid.Column="0" Orientation="Horizontal">
                    <TextBlock Text="ðŸŸ" FontSize="24" Margin="0,0,10,0" VerticalAlignment="Center"/>
                    <TextBlock Text="æ‘¸é±¼åŠžä»ªè¡¨ç›˜" FontSize="24" FontWeight="Bold" VerticalAlignment="Center"/>
                    <TextBlock Text="v1.0" FontSize="14" Margin="10,5,0,0" 
                              VerticalAlignment="Top" Opacity="0.8"/>
                </StackPanel>
                
                <StackPanel Grid.Column="1" HorizontalAlignment="Right">
                    <TextBlock x:Name="CurrentTimeText" FontSize="16" HorizontalAlignment="Right"/>
                    <TextBlock x:Name="TimeZoneText" FontSize="12" Opacity="0.7" HorizontalAlignment="Right"/>
                </StackPanel>
            </Grid>
        </materialDesign:ColorZone>
        
        <!-- å‰¯æ ‡é¢˜ -->
        <TextBlock Grid.Row="1" Text="æ—¥åŽ† Â· æ°”æ³¡åŠ¨ç”» Â· æœ¬åœ°ä¿å­˜" 
                  Margin="20,5,20,10" FontSize="14" Opacity="0.7"/>
        
        <!-- ä¸»è¦å†…å®¹åŒºåŸŸ -->
        <ScrollViewer Grid.Row="2" VerticalScrollBarVisibility="Auto">
            <UniformGrid Columns="2" Margin="10,0">
                
                <!-- ä»Šæ—¥æ‘¸é±¼è¿›åº¦ -->
                <materialDesign:Card Style="{StaticResource MoyuCardStyle}">
                    <StackPanel>
                        <TextBlock Text="ä»Šæ—¥æ‘¸é±¼è¿›åº¦" Style="{StaticResource ModuleTitleStyle}"/>
                        <ProgressBar x:Name="TodayProgressBar" Style="{StaticResource MoyuProgressBar}"/>
                        <TextBlock x:Name="TodayProgressText" FontSize="14" Opacity="0.8" 
                                  Style="{StaticResource EditableTextStyle}"
                                  MouseLeftButtonDown="ModuleText_MouseLeftButtonDown"/>
                    </StackPanel>
                </materialDesign:Card>
                
                <!-- æœ¬å‘¨æ‘¸é±¼è¿›åº¦ -->
                <materialDesign:Card Style="{StaticResource MoyuCardStyle}">
                    <StackPanel>
                        <TextBlock Text="æœ¬å‘¨æ‘¸é±¼è¿›åº¦" Style="{StaticResource ModuleTitleStyle}"/>
                        <ProgressBar x:Name="WeekProgressBar" Style="{StaticResource MoyuProgressBar}"/>
                        <TextBlock x:Name="WeekProgressText" FontSize="14" Opacity="0.8"
                                  Style="{StaticResource EditableTextStyle}"
                                  MouseLeftButtonDown="ModuleText_MouseLeftButtonDown"/>
                    </StackPanel>
                </materialDesign:Card>
                
                <!-- è·ç¦»å‘¨æœ« -->
                <materialDesign:Card Style="{StaticResource MoyuCardStyle}">
                    <StackPanel>
                        <TextBlock Text="è·ç¦»å‘¨æœ«" Style="{StaticResource ModuleTitleStyle}"/>
                        <TextBlock x:Name="WeekendText" FontSize="16" Margin="0,10,0,0"
                                  Style="{StaticResource EditableTextStyle}"
                                  MouseLeftButtonDown="ModuleText_MouseLeftButtonDown"/>
                    </StackPanel>
                </materialDesign:Card>
                
                <!-- è·ç¦»å‘å·¥èµ„ -->
                <materialDesign:Card Style="{StaticResource MoyuCardStyle}">
                    <StackPanel>
                        <TextBlock x:Name="SalaryTitleText" Text="è·ç¦»å‘å·¥èµ„ï¼ˆ10å·ï¼‰" 
                                  Style="{StaticResource ModuleTitleStyle}"/>
                        <TextBlock x:Name="SalaryText" FontSize="16" Margin="0,10,0,0"
                                  Style="{StaticResource EditableTextStyle}"
                                  MouseLeftButtonDown="ModuleText_MouseLeftButtonDown"/>
                    </StackPanel>
                </materialDesign:Card>
                
                <!-- è‡ªå®šä¹‰å€’è®¡æ—¶ -->
                <materialDesign:Card Style="{StaticResource MoyuCardStyle}">
                    <StackPanel>
                        <TextBlock Text="è‡ªå®šä¹‰å€’è®¡æ—¶" Style="{StaticResource ModuleTitleStyle}"/>
                        <ListBox x:Name="CustomCountdownList" 
                                materialDesign:ListBoxAssist.IsToggle="False"
                                MaxHeight="150"
                                ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                                BorderThickness="0"
                                Background="Transparent">
                            <ListBox.ItemTemplate>
                                <DataTemplate>
                                    <Grid Margin="5">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        
                                        <StackPanel Grid.Column="0" Orientation="Horizontal">
                                            <Button Style="{StaticResource MaterialDesignFlatButton}"
                                                   Content="{Binding Name}" 
                                                   Tag="{Binding}"
                                                   Click="EditCustomCountdownName_Click"
                                                   FontWeight="SemiBold" 
                                                   Width="120"
                                                   HorizontalContentAlignment="Left"
                                                   Padding="4,2"/>
                                            <Button Style="{StaticResource MaterialDesignFlatButton}"
                                                   Tag="{Binding}"
                                                   Click="EditCustomCountdownDate_Click"
                                                   Margin="10,0,0,0" 
                                                   Opacity="0.7" 
                                                   FontSize="12"
                                                   HorizontalContentAlignment="Left"
                                                   Padding="4,2">
                                                <TextBlock Text="{Binding Date, StringFormat='{}{0:yyyy-MM-dd}'}" />
                                            </Button>
                                        </StackPanel>
                                        
                                        <StackPanel Grid.Column="1" Orientation="Horizontal">
                                            <Button Style="{StaticResource MaterialDesignFlatButton}"
                                                   Content="ç¼–è¾‘" Tag="{Binding}"
                                                   Click="EditCustomCountdownButton_Click"
                                                   Foreground="{DynamicResource MaterialDesignBodyLightBrush}"
                                                   Padding="8,4,8,4"/>
                                            <Button Style="{StaticResource MaterialDesignFlatButton}"
                                                   Content="åˆ é™¤" Tag="{Binding}"
                                                   Click="DeleteCustomCountdownButton_Click"
                                                   Foreground="{DynamicResource MaterialDesignValidationErrorBrush}"
                                                   Padding="8,4,8,4"/>
                                        </StackPanel>
                                    </Grid>
                                </DataTemplate>
                            </ListBox.ItemTemplate>
                        </ListBox>
                        <Button x:Name="AddCustomCountdownButton" 
                               Content="+ æ·»åŠ å€’è®¡æ—¶" 
                               Margin="0,10,0,0"
                               Style="{StaticResource MaterialDesignOutlinedButton}"
                               Click="AddCustomCountdownButton_Click"/>
                    </StackPanel>
                </materialDesign:Card>
                
                <!-- èŠ‚å‡æ—¥å€’è®¡æ—¶ -->
                <materialDesign:Card Style="{StaticResource MoyuCardStyle}">
                    <StackPanel>
                        <TextBlock Text="èŠ‚å‡æ—¥å€’è®¡æ—¶" Style="{StaticResource ModuleTitleStyle}"/>
                        <ListBox x:Name="HolidayCountdownList"
                                materialDesign:ListBoxAssist.IsToggle="False"
                                MaxHeight="150"
                                ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                                BorderThickness="0"
                                Background="Transparent"/>
                    </StackPanel>
                </materialDesign:Card>
                
                <!-- é€€ä¼‘å€’è®¡æ—¶ -->
                <materialDesign:Card Style="{StaticResource MoyuCardStyle}">
                    <StackPanel>
                        <TextBlock Text="é€€ä¼‘å€’è®¡æ—¶" Style="{StaticResource ModuleTitleStyle}"/>
                        <TextBlock x:Name="RetireInfoText" FontSize="12" Opacity="0.7" Margin="0,0,0,10"/>
                        <ProgressBar x:Name="RetireProgressBar" Style="{StaticResource MoyuProgressBar}"/>
                        <TextBlock x:Name="RetireRemainingText" FontSize="14" Margin="0,5,0,0"
                                  Style="{StaticResource EditableTextStyle}"
                                  MouseLeftButtonDown="ModuleText_MouseLeftButtonDown"/>
                        
                        <Separator Margin="0,15,0,10" Style="{StaticResource MaterialDesignSeparator}"/>
                        
                        <TextBlock Text="ç”Ÿæ—¥å€’è®¡æ—¶" FontSize="14" FontWeight="SemiBold" Margin="0,0,0,5"/>
                        <TextBlock x:Name="BirthdayInfoText" FontSize="12" Opacity="0.7" Margin="0,0,0,10"/>
                        <ProgressBar x:Name="BirthdayProgressBar" Style="{StaticResource MoyuProgressBar}"/>
                        <TextBlock x:Name="BirthdayRemainingText" FontSize="14" Margin="0,5,0,0"
                                  Style="{StaticResource EditableTextStyle}"
                                  MouseLeftButtonDown="ModuleText_MouseLeftButtonDown"/>
                    </StackPanel>
                </materialDesign:Card>
                
                <!-- æ‘¸é±¼è¯­å½• -->
                <materialDesign:Card Style="{StaticResource MoyuCardStyle}">
                    <StackPanel>
                        <TextBlock Text="æ‘¸é±¼è¯­å½•" Style="{StaticResource ModuleTitleStyle}"/>
                        <TextBlock x:Name="QuoteText" FontSize="16" FontStyle="Italic"
                                  TextAlignment="Center" Margin="0,20,0,10"
                                  Opacity="0.9" TextWrapping="Wrap"
                                  Style="{StaticResource EditableTextStyle}"
                                  MouseLeftButtonDown="ModuleText_MouseLeftButtonDown"/>
                    </StackPanel>
                </materialDesign:Card>
            </UniformGrid>
        </ScrollViewer>
        
        <!-- åº•éƒ¨ç‰ˆæƒ -->
        <TextBlock Grid.Row="3" Text="Â© 2025 æ‘¸é±¼åŠž Â· æ¡Œé¢ç‰ˆ" 
                  HorizontalAlignment="Center" Margin="0,10,0,15"
                  FontSize="12" Opacity="0.6"/>
        
        <!-- è®¾ç½®æŒ‰é’® -->
        <Button Grid.Row="3" HorizontalAlignment="Right" VerticalAlignment="Bottom"
               Margin="0,0,30,30" Width="60" Height="60"
               Style="{StaticResource FloatingActionButtonStyle}"
               Click="SettingsButton_Click">
            <materialDesign:PackIcon Kind="Cog" Width="30" Height="30"/>
        </Button>
        
        <!-- ç¼–è¾‘æ¨¡å¼è¦†ç›–å±‚ -->
        <Border x:Name="EditModeOverlay" Grid.RowSpan="4" Background="#80000000"
               Visibility="Collapsed" MouseLeftButtonDown="EditModeOverlay_MouseLeftButtonDown">
            <Border Background="White" CornerRadius="8" Padding="20" 
                   HorizontalAlignment="Center" VerticalAlignment="Center"
                   Width="400" MouseLeftButtonDown="EditPanel_MouseLeftButtonDown">
                <StackPanel>
                    <TextBlock x:Name="EditTitle" FontSize="18" FontWeight="Bold" Margin="0,0,0,15"/>
                    <TextBox x:Name="EditTextBox" 
                            materialDesign:TextFieldAssist.HasOutlinedTextField="True"
                            Margin="0,0,0,20"/>
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                        <Button x:Name="SaveEditButton" Content="ä¿å­˜" 
                               Style="{StaticResource MaterialDesignRaisedButton}"
                               Margin="0,0,10,0" Click="SaveEditButton_Click"/>
                        <Button x:Name="CancelEditButton" Content="å–æ¶ˆ" 
                               Style="{StaticResource MaterialDesignOutlinedButton}"
                               Click="CancelEditButton_Click"/>
                    </StackPanel>
                </StackPanel>
            </Border>
        </Border>
        
        <!-- è®¾ç½®é¢æ¿ -->
        <Border x:Name="SettingsPanel" Grid.RowSpan="4" 
               HorizontalAlignment="Right" VerticalAlignment="Bottom"
               Margin="0,0,100,100" Width="380" MaxHeight="600"
               CornerRadius="12" Background="White"
               BorderBrush="{DynamicResource MaterialDesignDivider}" BorderThickness="1"
               Visibility="Collapsed">
            <ScrollViewer VerticalScrollBarVisibility="Auto">
                <StackPanel Margin="20">
                    <TextBlock Text="è®¾ç½®" FontSize="20" FontWeight="Bold" Margin="0,0,0,20"/>
                    
                    <TextBlock Text="è®¾ç½®æ‚¨çš„ä¸Šç­æ—¶é—´æ®µ" FontSize="12" Opacity="0.7" Margin="0,0,0,10"/>
                    <TextBlock Text="å·¥ä½œæ—¶é—´" FontWeight="SemiBold" Margin="0,0,0,10"/>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="20"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <TextBox x:Name="StartTimeTextBox" Grid.Column="0" 
                                materialDesign:TextFieldAssist.HasOutlinedTextField="True"
                                materialDesign:HintAssist.Hint="ä¸Šç­æ—¶é—´"/>
                        <TextBlock Grid.Column="1" Text="-" VerticalAlignment="Center" 
                                  HorizontalAlignment="Center" FontSize="16"/>
                        <TextBox x:Name="EndTimeTextBox" Grid.Column="2"
                                materialDesign:TextFieldAssist.HasOutlinedTextField="True"
                                materialDesign:HintAssist.Hint="ä¸‹ç­æ—¶é—´"/>
                    </Grid>
                    
                    <TextBlock Text="è®¾ç½®æ‚¨çš„ç”Ÿæ—¥" FontSize="12" Opacity="0.7" Margin="0,15,0,5"/>
                    <DatePicker x:Name="HireDatePicker" Margin="0,0,0,0"
                            materialDesign:TextFieldAssist.HasOutlinedTextField="True"
                            materialDesign:HintAssist.Hint="å‡ºç”Ÿæ—¥æœŸ"/>
                    
                    <TextBlock Text="è®¾ç½®å‘è–ªæ—¥æœŸå’Œå·¥ä½œæ—¥èŒƒå›´" FontSize="12" Opacity="0.7" Margin="0,15,0,5"/>
                    <TextBox x:Name="SalaryDayTextBox" Margin="0,0,0,0"
                            materialDesign:TextFieldAssist.HasOutlinedTextField="True"
                            materialDesign:HintAssist.Hint="å‘è–ªæ—¥æœŸï¼ˆ1-31ï¼‰"/>
                    
                    <TextBox x:Name="WeekdaysTextBox" Margin="0,5,0,0"
                            materialDesign:TextFieldAssist.HasOutlinedTextField="True"
                            materialDesign:HintAssist.Hint="å·¥ä½œæ—¥èŒƒå›´ï¼ˆ1-7ï¼Œä¾‹å¦‚ 1-5ï¼‰"/>
                    
                    <TextBlock Text="è®¾ç½®é€€ä¼‘å¹´é¾„ï¼ˆæ€§åˆ«é€‰æ‹©ï¼‰" FontSize="12" Opacity="0.7" Margin="0,15,0,5"/>
                    <ComboBox x:Name="GenderComboBox" Margin="0,0,0,0"
                             materialDesign:HintAssist.Hint="æ€§åˆ«ï¼ˆç”¨äºŽé€€ä¼‘å¹´é¾„è®¡ç®—ï¼‰">
                        <ComboBoxItem Content="ç”·ï¼ˆ60å²ï¼‰" Tag="male"/>
                        <ComboBoxItem Content="å¥³ï¼ˆ55å²ï¼‰" Tag="female"/>
                    </ComboBox>
                    
                    <TextBlock Text="è®¾ç½®ç•Œé¢æ˜¾ç¤ºå’Œæ›´æ–°é¢‘çŽ‡" FontSize="12" Opacity="0.7" Margin="0,15,0,5"/>
                    <TextBox x:Name="RefreshIntervalTextBox" Margin="0,0,0,0"
                            materialDesign:TextFieldAssist.HasOutlinedTextField="True"
                            materialDesign:HintAssist.Hint="åˆ·æ–°é—´éš”ï¼ˆç§’ï¼Œæœ€å°5ï¼‰"/>
                    
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,30,0,0">
                        <Button x:Name="SaveSettingsButton" Content="ä¿å­˜" 
                               Style="{StaticResource MaterialDesignRaisedButton}"
                               Margin="0,0,10,0" Click="SaveSettingsButton_Click"/>
                        <Button x:Name="CloseSettingsButton" Content="å…³é—­" 
                               Style="{StaticResource MaterialDesignOutlinedButton}"
                               Click="CloseSettingsButton_Click"/>
                    </StackPanel>
                </StackPanel>
            </ScrollViewer>
        </Border>
    </Grid>
</Window>